Upgrade Procedure for IVLE
==========================

Upgrading to a new version of IVLE is generally fairly painless, but
there are several steps involved.

Firstly, in the IVLE checkout, bring your codebase up to date:

  svn up

Then build IVLE:

  ./setup.py build

Now comes the time to block external access to IVLE. Stopping Apache
on each server in the cluster and killing any remaining python-console
processes is highly recommended.

You should then run any outstanding database migrations. A note of the
latest applied migration should probably be kept somewhere to avoid
running the same one twice. This command must be run once for each.

  sudo -u postgres psql ivle < userdb/migrations/YYYYMMDD-NN.sql

Now we can install the new version, and update the jails:

  sudo ./setup.py install
  sudo ivle-buildjail

Note that this will not perform a full rebuild of the template jail -
only the IVLE files inside the jail will be updated. To force a full
jail rebuild, give ivle-buildjail the -r option.

... and remake the user jails, as this will occasionally be needed:

  ivle-remakeuser --all --verbose

Restart the usrmgt-server and all Apaches, reenable external access,
check that everything works, and you're done!
