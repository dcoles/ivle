<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/">
  <head>
    <title>Submit project</title>
  </head>
  <body>
    <h1>Submit project</h1>
    <div id="ivle_padding">
      <py:choose test="offering">
        <div py:when="None">
          <p>You may not submit files from <span style="font-family: monospace">${path}</span> in
            <py:choose test="">
              <span py:when="principal is req.user">your repository.</span>
              <span py:otherwise="">the repository for ${principal.display_name}.</span>
            </py:choose>
            You can only submit files from a subject directory.
          </p>
        </div>
        <div py:otherwise="">
          <p>You are submitting <span style="font-family: monospace">${path}</span> from
            <py:choose test="">
              <span py:when="principal is req.user">your repository.</span>
              <span py:otherwise="">the repository for ${principal.display_name}.</span>
            </py:choose>
          </p>
          <p>You may submit to any open project in ${offering.subject.name}. Which project do you wish to submit this for?</p>
          <form action="" method="post">
            <table>
              <tr py:for="project in principal.get_projects(offering=offering)"
                  py:with="attrs = {'disabled': 'disabled'} if project.has_deadline_passed(req.user) else {}">
                <td style="vertical-align: top">
                  <input type="radio" name="project" id="project_${project.id}" value="${project.id}" py:attrs="attrs" />
                </td>
                <td>
                  <!-- XXX This deadline does not take the student's extensions into account. -->
                  <label for="project_${project.id}"><a href="${project.url}">${project.name}</a> (<span title="Due ${format_datetime(project.deadline)}">due ${format_datetime_short(project.deadline)}</span>)<br />${project.synopsis}</label>
                </td>
              </tr>
            </table>
            <p>Ensure that you have committed all changes - only changes in the repository will be submitted.</p>
            <p>You may resubmit a project again at any time until its deadline.</p>
            <p><input type="submit" value="Submit Project" /></p>
          </form>
        </div>
      </py:choose>
    </div>
  </body>
</html>
